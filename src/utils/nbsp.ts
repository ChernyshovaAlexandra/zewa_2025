/**
 * Заменяет пробелы на неразрывные (&nbsp;) в следующих случаях:
 * 1. Между короткими словами (1–2 буквы), чтобы предлоги и частицы не оставались в конце строки.
 * 2. Между числом (в том числе с десятичной частью) и знаками:
 *    – процента (%),
 *    – промилле (‰),
 *    – градуса (°),
 *    – валют (₽, $, €, £, ¥).
 * 3. Между числом и словом (единицей измерения или любым словом).
 */
export function applyNbsp(input: string): string {
  return (
    input
    .replace(/(\d) (\d)/g, '$1\u00A0$2')
      // 1. Короткие слова (1–2 буквы) + пробел
      .replace(/(\s|^)([а-яА-ЯёЁA-Za-z]{1,2}) /g, '$1$2\u00A0')
      // 2. Число (целое или десятичное) + пробел + знак (% ‰ ° ₽ $ € £ ¥)
      .replace(/([\d ]+(?:[.,]\d+)?)\s+([%‰°₽$€£¥])/g, '$1\u00A0$2')
      // 3. Число (целое или десятичное) + пробел + слово (единица измерения или любое слово)
      .replace(/(\d+(?:[.,]\d+)?)\s+([A-Za-zА-Яа-яЁё]+)/g, '$1\u00A0$2')
  );
}
